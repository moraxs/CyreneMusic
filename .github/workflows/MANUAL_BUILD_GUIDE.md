# 手动触发构建指南

## 📝 概述

GitHub Actions 工作流支持手动触发，允许你选择性地构建特定平台，而不是一次构建所有平台。

## 🎯 何时使用手动触发

- 🧪 **测试新功能**：只构建需要测试的平台
- 💾 **节省配额**：私有仓库配额有限时，只构建必要的平台
- 🔧 **快速调试**：单独构建某个平台以排查构建问题
- 📱 **移动端专注**：只需要 Android 和 iOS 版本
- 🖥️ **桌面端专注**：只需要 Windows、Linux、macOS 版本

## 🚀 操作步骤

### 1. 进入 Actions 页面

在 GitHub 仓库页面，点击顶部的 **Actions** 标签。

### 2. 选择工作流

在左侧列表中，选择 **Multi-Platform Build** 工作流。

### 3. 点击 Run workflow

点击右上角的 **Run workflow** 按钮。

### 4. 配置构建选项

会弹出一个对话框，显示以下选项：

```
Use workflow from: [Branch: master ▼]

构建选项：
☑ 构建 Android
☑ 构建 Windows  
☑ 构建 Linux
☑ 构建 macOS
☑ 构建 iOS

[Run workflow]
```

**所有选项默认都已勾选**，你可以：
- ✅ **保持勾选** - 构建该平台
- ⬜ **取消勾选** - 跳过该平台

### 5. 运行工作流

配置完成后，点击绿色的 **Run workflow** 按钮开始构建。

## 📋 使用场景示例

### 场景 1：只构建 Android

适用于：快速测试 Android 版本

**配置**：
- ✅ 构建 Android
- ⬜ 构建 Windows
- ⬜ 构建 Linux
- ⬜ 构建 macOS
- ⬜ 构建 iOS

**时间**：约 5-8 分钟

### 场景 2：桌面平台（Windows + Linux + macOS）

适用于：测试桌面端功能

**配置**：
- ⬜ 构建 Android
- ✅ 构建 Windows
- ✅ 构建 Linux
- ✅ 构建 macOS
- ⬜ 构建 iOS

**时间**：约 6-8 分钟（并行构建）

### 场景 3：移动平台（Android + iOS）

适用于：移动端专项测试

**配置**：
- ✅ 构建 Android
- ⬜ 构建 Windows
- ⬜ 构建 Linux
- ⬜ 构建 macOS
- ✅ 构建 iOS

**时间**：约 8 分钟

### 场景 4：单一平台调试

适用于：排查特定平台的构建问题

**配置**：只勾选需要调试的平台

**时间**：约 3-8 分钟（取决于平台）

### 场景 5：全平台构建

适用于：发布前的完整测试

**配置**：保持所有选项勾选（默认）

**时间**：约 8-10 分钟

## 📦 获取构建产物

### 查看构建进度

1. 点击刚才触发的工作流运行记录
2. 查看各个平台的构建进度
3. 等待构建完成（绿色 ✓）

### 下载 Artifacts

构建完成后：

1. 滚动到页面底部的 **Artifacts** 区域
2. 会看到已构建平台的产物：
   - `android-apk` - Android APK 文件
   - `windows-x64` - Windows ZIP 压缩包
   - `linux-x64` - Linux tar.gz 包
   - `macos` - macOS DMG 磁盘映像
   - `ios-unsigned` - iOS IPA（未签名）

3. 点击对应的 Artifact 名称下载

**注意**：
- ⚠️ 手动触发**不会创建 GitHub Release**
- 📁 Artifacts 保留 **90 天**
- 💾 只有勾选的平台才会生成对应的 Artifact

## 🆚 对比：标签触发 vs 手动触发

| 特性 | 标签触发 | 手动触发 |
|------|---------|----------|
| **触发方式** | `git push origin v1.0.4` | Actions 页面点击 |
| **构建平台** | 全部平台 | 可选择 |
| **创建 Release** | ✅ 自动创建 | ❌ 不创建 |
| **产物位置** | Release 页面 | Artifacts |
| **保留时间** | 永久 | 90 天 |
| **适用场景** | 正式发布 | 测试、调试 |

## 💡 最佳实践

### 1. 节省配额
如果你的仓库是私有的，GitHub Actions 有配额限制：
- **免费账号**：每月 2000 分钟
- **Pro 账号**：每月 3000 分钟

**建议**：
- 开发期间：只构建需要测试的平台
- 发布前：使用标签触发，构建所有平台

### 2. 快速迭代
在开发新功能时：
- 先手动触发，只构建主要测试平台（如 Android）
- 验证通过后，再构建其他平台
- 最后推送标签，创建正式 Release

### 3. 调试构建问题
如果某个平台构建失败：
- 单独触发该平台的构建
- 查看详细的构建日志
- 修复后重新测试

### 4. 并行开发
不同开发者可以：
- A 开发者：测试 Android 和 iOS
- B 开发者：测试 Windows 和 Linux
- 各自触发需要的平台，互不干扰

## ❓ 常见问题

### Q: 为什么手动触发不创建 Release？
A: 手动触发主要用于测试和开发，避免创建过多的 Release。正式发布时使用标签触发。

### Q: 可以修改默认选项吗？
A: 可以编辑 `.github/workflows/build.yml`，修改 `default: true/false` 来改变默认勾选状态。

### Q: 取消勾选的平台会跳过吗？
A: 是的，取消勾选的平台完全不会运行，节省时间和配额。

### Q: 手动触发和标签触发有什么本质区别？
A: 
- 标签触发：`if` 条件包含 `github.event_name == 'push'`
- 手动触发：`if` 条件检查 `inputs.build_xxx` 的值
- Release 创建：只在标签触发时执行

### Q: Artifacts 可以转为 Release 吗？
A: 可以手动创建 Release，然后上传下载的 Artifacts。但建议直接使用标签触发自动创建。

## 🔗 相关文档

- [GitHub Actions 构建指南](../../docs/GITHUB_ACTIONS_BUILD.md)
- [自动构建说明](README.md)
- [完成总结](../../GITHUB_ACTIONS_SUMMARY.md)

## 📝 总结

手动触发构建提供了灵活的构建控制：
- ✅ 选择性构建平台
- ⏱️ 节省时间和配额
- 🧪 便于测试和调试
- 📦 快速获取构建产物

对于日常开发和测试，推荐使用手动触发；对于正式发布，使用标签触发自动创建 Release。


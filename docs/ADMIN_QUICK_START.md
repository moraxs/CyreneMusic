# 管理员后台 - 快速开始指南

## 🚀 5分钟上手

### 步骤 1：启动后端服务

```bash
cd backend
bun run src/index.ts
```

确认看到日志输出：
```
=== Admin Panel ===
- POST /admin/login (Admin Login)
- POST /admin/logout (Admin Logout)
- GET /admin/users (Get All Users)
- GET /admin/stats (Get User Statistics)
- DELETE /admin/users (Delete User)
```

### 步骤 2：启动前端应用

```bash
flutter run
```

### 步骤 3：进入开发者模式

1. 打开应用
2. 进入「设置」页面
3. 滚动到底部
4. 快速点击版本号 **5次**
5. 看到提示「开发者模式已启用」

### 步骤 4：访问管理员后台

1. 返回首页
2. 在侧边栏/底部导航找到「开发者」选项
3. 进入开发者页面
4. 切换到「数据」标签页

### 步骤 5：管理员登录

1. 看到登录界面
2. 输入密码：`morax2237`
3. 点击「登录」按钮
4. 登录成功！自动加载数据

### 步骤 6：查看用户数据

**用户列表：**
- 查看所有注册用户
- 点击用户卡片查看详情
- 查看IP归属地信息

**统计数据：**
- 用户概览（总数、验证数等）
- 地区分布柱状图
- 注册趋势

## 📸 界面预览

### 登录界面
```
┌─────────────────────────────┐
│      👑 管理员后台            │
│    需要验证管理员身份         │
│                             │
│  ┌───────────────────────┐  │
│  │ 🔒 管理员密码          │  │
│  │ ••••••••             👁 │  │
│  └───────────────────────┘  │
│                             │
│      [ 登 录 ]              │
└─────────────────────────────┘
```

### 用户列表
```
┌─────────────────────────────┐
│ 👥 用户列表  📊 统计数据     │
│ ──────────────────────────  │
│ 🔄 刷新           🚪 退出    │
├─────────────────────────────┤
│                             │
│ ┌─────────────────────────┐ │
│ │ 👤 张三    user@qq.com  │ │
│ │ ✅ 已验证           🗑️  │ │
│ └─────────────────────────┘ │
│                             │
│ ┌─────────────────────────┐ │
│ │ 👤 李四    test@qq.com  │ │
│ │ ⏳ 未验证           🗑️  │ │
│ └─────────────────────────┘ │
│                             │
└─────────────────────────────┘
```

### 统计数据
```
┌─────────────────────────────┐
│  📊 用户概览                 │
│ ───────────────────────────  │
│                             │
│  👥       ✅       ⏳      │
│  100      85      15       │
│ 总用户   已验证   未验证     │
│                             │
│  🆕       📈       📅      │
│   5        8       23      │
│今日新增  今日活跃  本周新增  │
│                             │
│ ─────────────────────────── │
│                             │
│  📍 地区分布 Top 10          │
│                             │
│  广东 深圳  ████████  45人  │
│  北京 北京  ██████    30人  │
│  上海 上海  ████      20人  │
│                             │
└─────────────────────────────┘
```

## ⚡ 常用操作

### 查看用户详情

1. 在用户列表中找到目标用户
2. 点击用户卡片
3. 展开后查看完整信息：
   - 用户ID
   - 注册时间
   - 最后登录
   - IP地址
   - IP归属地
   - 验证状态

### 删除用户

⚠️ **危险操作！**

1. 点击用户卡片右侧的 🗑️ 图标
2. 确认对话框弹出
3. 再次确认
4. 用户被永久删除

### 刷新数据

点击顶部工具栏的 🔄 刷新按钮，重新获取最新数据。

### 退出管理员

1. 点击顶部工具栏的「退出」按钮
2. 确认退出
3. 返回登录界面

## 🔍 测试建议

### 1. 创建测试用户

在应用中注册几个测试账号：
- 使用 QQ 邮箱（自动获取头像）
- 不同地区的 IP 地址
- 完成/未完成邮箱验证

### 2. 模拟不同场景

**用户增长：**
- 注册多个账号查看统计变化
- 不同时间登录查看活跃趋势

**地区分布：**
- 使用不同网络环境登录
- 查看地区分布变化

**数据管理：**
- 测试用户删除功能
- 查看删除后的统计更新

### 3. 测试会话管理

**会话过期测试：**
1. 登录管理员后台
2. 等待超过 1 小时（或修改配置为更短时间）
3. 尝试刷新数据
4. 应该自动退出登录

**多设备登录：**
1. 在不同设备/浏览器登录
2. 每个会话独立工作
3. 互不影响

## 🐛 常见问题

### Q: 密码正确但无法登录？

**A:** 检查后端服务器是否正常运行：
```bash
# 查看后端日志
cd backend
bun run src/index.ts
```

### Q: 看不到任何用户？

**A:** 数据库可能为空，先注册一些测试用户。

### Q: 删除用户后如何恢复？

**A:** **无法恢复！** 删除操作会永久删除数据库记录。建议：
- 生产环境慎用删除功能
- 定期备份数据库文件

### Q: 如何修改管理员密码？

**A:** 编辑 `backend/config.json`：
```json
{
  "admin": {
    "password": "your_new_password"
  }
}
```

重启后端服务器生效。

### Q: 会话有效期可以调整吗？

**A:** 可以，在 `backend/config.json` 中修改：
```json
{
  "admin": {
    "session_duration": 7200  // 2小时（单位：秒）
  }
}
```

## 📊 数据说明

### 统计数据更新频率

- **实时数据：** 用户列表、用户数量
- **准实时：** 统计数据（刷新时重新计算）
- **历史数据：** 注册趋势（来自数据库历史记录）

### 数据库位置

```
backend/data/users.db
```

### 备份建议

定期备份数据库文件：
```bash
# 创建备份
cp backend/data/users.db backend/data/users.db.backup

# 带日期的备份
cp backend/data/users.db "backend/data/users.db.$(date +%Y%m%d_%H%M%S)"
```

## 🎯 下一步

- 查看完整文档：[ADMIN_PANEL.md](ADMIN_PANEL.md)
- 了解 API 接口：[backend/README.md](../backend/README.md)
- 学习数据库结构：[backend/src/lib/database.ts](../backend/src/lib/database.ts)

## ✅ 完成！

恭喜！你已经掌握了管理员后台的基本使用。

**提示：** 记得在生产环境修改默认密码！🔐

